<div class="p-6 bg-slate-50 min-h-screen rtl">
  <div class="max-w-6xl mx-auto">
    <div
      class="flex flex-col md:flex-row justify-between items-center bg-white p-6 rounded-3xl shadow-sm mb-6 border border-slate-100 gap-4"
    >
      <div>
        <h1 class="text-2xl font-black text-text-dark">إدارة المقرارات المادة</h1>
        <p class="text-text-muted">تحكم في المقرارات</p>
      </div>
      <p-button
        label="إضافة قسم جديد"
        icon="pi pi-plus"
        (onClick)="openAddDialog()"
        styleClass="rounded-2xl px-6 py-3 font-bold"
      ></p-button>
    </div>
    <div class="bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden">
      <p-table
        [value]="curriculumFacade.curriculums()"
        [loading]="curriculumFacade.isLoading()"
        [showGridlines]="true"
        [stripedRows]="true"
        [resizableColumns]="true"
        [reorderableColumns]="true"
        [rowHover]="true"
        styleClass="p-datatable-gridlines p-datatable-striped"
        [rowHover]="true"
      >
        <ng-template pTemplate="header">
          <tr>
            <th>القسم</th>
            <th>المستوى الدراسي</th>
            <th>الدكتور المحاضر</th>
            <th>الإجراءات</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-cur>
          <tr>
            <td>{{ cur.departmentName }}</td>
            <td>{{ cur.yearName }}</td>
            <td>{{ cur.doctorName }}</td>
            <td>
              <!-- btn isPublish -->
              <button
                pButton
                icon="pi pi-check"
                class="p-button-text p-button-success"
                (click)="togglePublish(cur.id)"
              ></button>
              <button
                pButton
                icon="pi pi-trash"
                class="p-button-text p-button-danger"
                (click)="delete(cur.id)"
              ></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <p-dialog
    [(visible)]="displayDialog"
    header="تخصيص المادة لمنهج"
    [modal]="true"
    [style]="{ width: '500px' }"
  >
    <div class="grid gap-4 mt-4">
      <div class="flex flex-col gap-2">
        <label>اختر الكلية</label>
        <p-select
          [options]="collegeFacade.colleges()"
          [(ngModel)]="selectedCollegeId"
          optionLabel="name"
          optionValue="id"
          placeholder="اختر الكلية"
        ></p-select>
      </div>

      <div class="flex flex-col gap-2">
        <label>اختر القسم</label>
        <p-select
          [options]="departmentFacade.departments()"
          [disabled]="selectedCollegeId() === null"
          [(ngModel)]="curriculumForm.departmentId"
          optionLabel="name"
          optionValue="id"
          placeholder="اختر القسم"
        ></p-select>
      </div>

      <div class="flex flex-col gap-2">
        <label>اختر المستوى</label>
        <p-select
          [options]="yearFacade.years()"
          [disabled]="selectedCollegeId() === null"
          [(ngModel)]="curriculumForm.yearId"
          optionLabel="name"
          optionValue="id"
          placeholder="اختر المستوى"
        ></p-select>
      </div>

      <div class="flex flex-col gap-2">
        <label>اختر الدكتور</label>
        <p-select
          [options]="curriculumFacade.doctors()"
          [(ngModel)]="curriculumForm.doctorId"
          optionLabel="fullName"
          optionValue="doctorId"
          placeholder="اختر الدكتور"
        ></p-select>
      </div>
      <!-- start month -->
      <div class="flex flex-col gap-2">
        <label>شهر البداية</label>
        <p-inputNumber
          [(ngModel)]="curriculumForm.startMonth"
          [min]="1"
          [max]="12"
          [showButtons]="true"
          buttonLayout="horizontal"
          spinnerMode="horizontal"
          inputStyleClass="text-center border-x-0"
          class="w-full"
          incrementButtonClass="p-button-secondary rounded-e-xl"
          decrementButtonClass="p-button-secondary"
          incrementButtonIcon="pi pi-plus"
          decrementButtonIcon="pi pi-minus"
        ></p-inputNumber>
      </div>
      <!-- end month -->
      <div class="flex flex-col gap-2">
        <label>شهر النهاية</label>
        <p-inputNumber
          [(ngModel)]="curriculumForm.endMonth"
          [min]="1"
          [max]="12"
          [showButtons]="true"
          buttonLayout="horizontal"
          spinnerMode="horizontal"
          inputStyleClass="text-center border-x-0"
          class="w-full"
          incrementButtonClass="p-button-secondary rounded-e-xl"
          decrementButtonClass="p-button-secondary"
          incrementButtonIcon="pi pi-plus"
          decrementButtonIcon="pi pi-minus"
        ></p-inputNumber>
      </div>
    </div>
    <ng-template pTemplate="footer">
      <p-button label="حفظ الربط" icon="pi pi-check" (onClick)="save()"></p-button>
    </ng-template>
  </p-dialog>
</div>
