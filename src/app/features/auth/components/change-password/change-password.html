<div class="min-h-screen flex items-stretch bg-surface" dir="auto">
  <div
    class="hidden lg:flex lg:w-1/2 bg-linear-to-br from-primary-700 via-primary-800 to-primary-900 items-center justify-center p-12 relative overflow-hidden"
  >
    <div class="relative text-center z-10">
      <div class="bg-surface/10 backdrop-blur-lg p-8 rounded-3xl border border-white/20 shadow-2xl">
        <div
          class="w-20 h-20 bg-surface/20 rounded-2xl flex items-center justify-center mx-auto mb-6"
        >
          <i class="pi pi-lock text-surface text-4xl block drop-shadow-lg"></i>
        </div>
        <h1 class="lg:text-4xl text-3xl font-black text-white mb-4 tracking-tight">حماية حسابك</h1>
        <p class="text-accent-soft text-lg lg:text-xl leading-relaxed max-w-md mx-auto">
          تأكد دائماً من اختيار كلمة مرور قوية وغير مكررة لضمان خصوصية بياناتك الأكاديمية.
        </p>
      </div>
    </div>
    <div
      class="absolute top-[-10%] right-[-10%] w-96 h-96 bg-surface/10 rounded-full blur-3xl"
    ></div>
    <div
      class="absolute bottom-[-10%] left-[-10%] w-80 h-80 bg-main/20 rounded-full blur-3xl"
    ></div>
  </div>

  <div class="w-full lg:w-1/2 flex items-center justify-center p-8 md:p-16 bg-gray-50">
    <div class="w-full max-w-md space-y-8">
      <div class="text-center lg:text-start">
        <h2 class="text-3xl font-bold text-text-main tracking-tight">تغيير كلمة المرور</h2>
        <p class="mt-2 text-text-muted font-medium">قم بتحديث بيانات الحماية الخاصة بك</p>
      </div>

      @if (authFacade.error()) {
        <p-message
          severity="error"
          [text]="authFacade.error()!"
          styleClass="w-full mb-4"
        ></p-message>
      }

      <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()" class="mt-8 space-y-5">
        <div class="flex flex-col gap-0.5">
          <label class="text-sm font-semibold text-text-main">كلمة المرور الحالية</label>
          <p-password
            formControlName="currentPassword"
            [toggleMask]="true"
            [feedback]="false"
            placeholder="أدخل الكلمة الحالية"
            styleClass="w-full"
            inputStyleClass="w-full p-3 rounded-xl border-gray-200 focus:border-indigo-500 shadow-sm"
          ></p-password>
          @if (
            changePasswordForm.get('currentPassword')?.touched &&
            changePasswordForm.get('currentPassword')?.hasError('required')
          ) {
            <small class="text-red-500 font-medium animate-fadein">هذا الحقل مطلوب</small>
          }
          @if (
            changePasswordForm.get('currentPassword')?.touched &&
            changePasswordForm.get('currentPassword')?.hasError('pattern')
          ) {
            <small class="text-red-500 font-medium animate-fadein"
              >كلمة المرور يجب ان تحتوى على حرف كبير وصغير ورقم ورمز واحد على الاقل</small
            >
          }
        </div>

        <hr class="border-gray-100 my-2" />

        <div class="flex flex-col gap-0.5">
          <label class="text-sm font-semibold text-text-main">كلمة المرور الجديدة</label>
          <p-password
            formControlName="newPassword"
            [toggleMask]="true"
            placeholder="أدخل الكلمة الجديدة"
            styleClass="w-full"
            inputStyleClass="w-full p-3 rounded-xl border-gray-200 focus:border-indigo-500 shadow-sm"
            promptLabel="اختر كلمة قوية"
            weakLabel="ضعيفة"
            mediumLabel="متوسطة"
            strongLabel="قوية جداً"
          ></p-password>
          @if (
            changePasswordForm.get('newPassword')?.touched &&
            changePasswordForm.get('newPassword')?.hasError('required')
          ) {
            <small class="text-red-500 font-medium animate-fadein">هذا الحقل مطلوب</small>
          }
          @if (
            changePasswordForm.get('newPassword')?.touched &&
            changePasswordForm.get('newPassword')?.hasError('pattern')
          ) {
            <small class="text-red-500 font-medium animate-fadein"
              >كلمة المرور يجب ان تحتوى على حرف كبير وصغير ورقم ورمز واحد على الاقل</small
            >
          }
        </div>

        <div class="flex flex-col gap-0.5">
          <label class="text-sm font-semibold text-text-main">تأكيد كلمة المرور الجديدة</label>
          <p-password
            formControlName="confidentialPassword"
            [toggleMask]="true"
            [feedback]="false"
            placeholder="أعد كتابة الكلمة الجديدة"
            styleClass="w-full"
            inputStyleClass="w-full p-3 rounded-xl border-gray-200 focus:border-indigo-500 shadow-sm"
          ></p-password>
          @if (
            changePasswordForm.get('confidentialPassword')?.touched &&
            changePasswordForm.hasError('passwordMismatch')
          ) {
            <small class="text-red-500 font-medium animate-fadein"
              >كلمتا المرور غير متطابقتين</small
            >
          }
        </div>

        <div class="pt-4">
          <button
            pButton
            type="submit"
            label="تحديث كلمة المرور"
            icon="pi pi-check-circle"
            [loading]="authFacade.isLoading()"
            [disabled]="changePasswordForm.invalid"
            class="w-full p-4 bg-main hover:bg-main-hover border-none rounded-xl text-lg font-bold shadow-lg shadow-accent-soft transition-all transform hover:-translate-y-0.5"
          ></button>
        </div>

        <div class="text-center">
          <a [routerLink]="['../']" class="text-main font-semibold cursor-pointer hover:underline">
            إلغاء والعودة للخلف
          </a>
        </div>
      </form>
    </div>
  </div>
</div>
